# Анализатор логов ADS-B и Mode S

## Описание
Программа для парсинга, глубокого анализа и визуализации авиационных логов (форматы ADS-B и Mode S). Скрипт автоматически распознаёт форматы сообщений, фильтрует данные, выводит детальную сводную таблицу с наносекундной точностью и запускает графический интерфейс для исследования параметров полёта и диагностики оборудования (анализ интервалов передачи).

---
## Функциональность

### 1. Парсинг и Сводная таблица
При запуске программа обрабатывает файл логов (автоматически в папке `data` или по указанному пути). В консоль выводится таблица со следующими данными:

* **ICAO** — уникальный 24-битный адрес самолета.
* **Рейс/SQ** — позывной (Callsign) или код ответчика (Squawk).
* **Формат** — перечень обнаруженных Downlink Formats (DF), например, DF11, DF17, DF20.
* **Первое / Последнее (UTC)** — временные метки с точностью до наносекунд (формат `HH:MM:SS.nnnnnnnnn`).
* **Флаги данных** (наличие (+) или отсутствие (-)):
    * **POS** — Координаты (широта/долгота, CPR декодирование).
    * **HDG** — Курс (Heading).
    * **SEL** — Выбранная высота на автопилоте (Selected Altitude MCP/FCU).
    * **DIF** — Разница высот (барометрическая vs GNSS).
    * **BAR** — Настройка барометра (Барокоррекция / QNH).
    * **GNS** — Геометрическая высота (GNSS высота).

\* Программа автоматически отфильтровывает из таблицы и графиков борта, не передающие ADS-B координаты (DF17/18), оставляя их только в общей статистике ("Всего бортов обнаружено").

### 2. Графический интерфейс
После обработки открывается окно с графиками.

**Управление:**
* **Кнопки "Пред. борт" / "След. борт"** (или стрелки ← / →) — выбор самолета.
* **Кнопки "Пред. график" / "След. график"** (или стрелки ↓ / ↑) — переключение режимов визуализации.
* **Колесо мыши** — масштабирование графика. Для карты (Track) работает умный зум к позиции курсора.

### 3. Доступные графики
Программа строит следующие типы визуализаций:

#### Навигационные параметры:
1.  **ОБЩАЯ КАРТА (All Tracks)** — траектории всех обнаруженных бортов (выбранный выделен красным).
2.  **Высота (Baro)** — барометрическая высота и выбранная высота (Selected Alt).
3.  **GNSS Высота** — геометрическая высота (расчетная: Baro + Разница высот).
4.  **Скорость** — приборная скорость (IAS/TAS).
5.  **Высота и Скорость** — комбинированный график (две оси Y).
6.  **Координаты** — график широты от времени.
7.  **Курс** — график изменения курса.
8.  **Схема трека** — 2D проекция пути конкретного борта.
9.  **Разница высот** — дельта между GNSS и барометрической высотой.
10. **Барокоррекция** — переданные настройки давления (QNH).

#### Диагностика транспондера (Анализ интервалов):
Программа строит гистограммы интервалов между сообщениями для проверки работы транспондера. Это позволяет выявить нарушения спецификаций DO-260B (слишком частые или редкие пакеты).

* **DF11** — Acquisition Squitter (Периодичность сквиттеров захвата).
* **REG05** — Airborne Position (Координаты в воздухе).
* **REG06** — Surface Position (Координаты на земле).
* **REG08** — Identification (Позывной).
* **REG09** — Velocity (Скорость).
* **REG61** — Emergency/Status (Статус).
* **REG62** — Target State and Status (Состояние цели).
* **REG65** — Aircraft Operational Status (Эксплуатационный статус).

---
## Требования и Установка

### Системные требования
* **Python:** Строго версия **3.10** или выше.
* **Встроенные модули:** `pathlib`, `argparse`, `datetime`, `sys`.

### Установка для Linux (Ubuntu / Debian / Mint)
Для работы графиков (`matplotlib`) на Linux необходимо установить системный пакет `python3-tk`.

1.  **Установите системные зависимости:**
    ```bash
    sudo apt update
    sudo apt install python3 python3-pip python3-venv python3-tk
    ```

2.  **Создайте и активируйте виртуальное окружение (рекомендуется):**
    ```bash
    python3 -m venv venv
    source venv/bin/activate
    ```

3.  **Установите библиотеки Python:**
    ```bash
    pip install numpy pyModeS matplotlib
    ```

### Установка для Windows
1.  Убедитесь, что установлен Python 3.10+.
2.  Откройте терминал (CMD/PowerShell) и выполните:
    ```bash
    pip install numpy pyModeS matplotlib
    ```

---
## Как использовать

1.  **Подготовка данных:**
    Создайте папку `data` рядом со скриптом и положите туда файлы логов (расширение `.t4433`, настраивается в `config.py`).

2.  **Запуск программы:**

    * **Автоматический режим:**
        Программа найдет первый файл в папке `data` и обработает его.
        ```bash
        python3 prog1.py
        ```

    * **Указание конкретного файла:**
        ```bash
        python3 prog1.py -f "путь/к/файлу.log"
        ```

    * **Фильтрация по одному борту (ICAO):**
        Загрузит файл, но построит графики только для указанного hex-адреса.
        ```bash
        python3 prog1.py -a 4249F5
        ```